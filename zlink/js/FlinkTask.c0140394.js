(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["FlinkTask"],{"0a72":function(t,e,s){},"0c81":function(t,e,s){"use strict";s("0a72")},"40f2":function(t,e,s){"use strict";s.r(e);var l=function(){var t=this,e=t._self._c;return e("div",[e("el-breadcrumb",{attrs:{"separator-class":"el-icon-arrow-right"}},[e("el-breadcrumb-item",{attrs:{to:{path:"/home"}}},[t._v("首页")]),e("el-breadcrumb-item",[t._v("flink-task")]),e("el-breadcrumb-item",[t._v("flink-task")])],1),e("el-card",[e("el-row",[t._v(" flink-task 信息 "),e("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"刷新 flink-task 信息",placement:"top"}},[e("el-button",{attrs:{type:"success",plain:"",icon:"el-icon-refresh",circle:""},on:{click:t.getLocalFlinkInfo}})],1),e("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"停止任务",placement:"top"}},[e("el-button",{attrs:{type:"danger",icon:"el-icon-close",circle:""},on:{click:t.stopFlinkTask}})],1),e("el-tooltip",{staticClass:"item",attrs:{effect:"dark",placement:"top"}},[e("div",{attrs:{slot:"content"},slot:"content"},[t._v("推送任务"),e("br"),t._v("目前支持 "+t._s(t.pushModel.toString()))]),e("el-button",{attrs:{type:"success",icon:"el-icon-s-promotion",circle:""},on:{click:function(e){t.pushTaskVisible=!0}}})],1)],1),e("el-table",{ref:"multipleTable",attrs:{data:t.flinkInfos,border:"",stripe:""},on:{"selection-change":t.handleSelectionChange}},[e("el-table-column",{attrs:{type:"selection",width:"55"}}),e("el-table-column",{attrs:{label:"jobId",prop:"jobId"}}),e("el-table-column",{attrs:{label:"模式",prop:"model"},scopedSlots:t._u([{key:"default",fn:function(s){return[e("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"local 模式下并行度为1",disabled:"local"!==s.row.model,placement:"top"}},["local"===s.row.model?e("el-tag",{attrs:{type:"danger"}},[t._v(t._s(s.row.model))]):e("el-tag",{attrs:{type:"success"}},[t._v(t._s(s.row.model))])],1)]}}])},[e("template",{slot:"header"},[e("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"目前支持 local, standalone, yarn, k8s",placement:"top"}},[e("span",[t._v(" 模式 "),e("i",{staticClass:"el-icon-question"})])])],1)],2),e("el-table-column",{attrs:{label:"url"},scopedSlots:t._u([{key:"default",fn:function(s){return[e("a",{attrs:{href:"http://"+s.row.url+"/#/overview",target:"_blank"}},[t._v("flink-web")])]}}])}),e("el-table-column",{attrs:{label:"任务状态",prop:"status"},scopedSlots:t._u([{key:"default",fn:function(s){return["RUNNING"===s.row.status?e("el-tag",{attrs:{type:"success"}},[t._v(t._s(s.row.status))]):e("el-tag",{attrs:{type:"danger"}},[t._v(t._s(s.row.status))])]}}])})],1)],1),e("el-dialog",{attrs:{title:"推送任务",visible:t.pushTaskVisible,width:"50%"},on:{"update:visible":function(e){t.pushTaskVisible=e},close:t.pushTaskClosed}},[e("el-form",{ref:"pushTaskFormRef",attrs:{model:t.pushTaskForm,"label-width":"140px"}},[e("el-form-item",{attrs:{label:"推送集群："}},[e("el-select",{attrs:{placeholder:"请选择"},on:{change:t.selectBtn},model:{value:t.pushTaskForm.clusterId,callback:function(e){t.$set(t.pushTaskForm,"clusterId",e)},expression:"pushTaskForm.clusterId"}},t._l(t.flinkConfList,(function(t){return e("el-option",{key:t.name,attrs:{label:t.name,value:t.id}})})),1)],1),e("el-form-item",{attrs:{label:"并行度："}},[e("el-input",{model:{value:t.pushTaskForm.parallelism,callback:function(e){t.$set(t.pushTaskForm,"parallelism",e)},expression:"pushTaskForm.parallelism"}})],1),t._l(t.flinkProps,(function(s,l){return e("div",{key:l},[e("el-row",{attrs:{gutter:24}},[e("el-col",{attrs:{span:10}},[e("el-form-item",{attrs:{label:"flink 配置参数:",prop:"name"}},[e("el-input",{attrs:{clearable:"",placeholder:"key"},model:{value:s.k,callback:function(e){t.$set(s,"k",e)},expression:"item.k"}})],1)],1),e("el-col",{attrs:{span:10}},[e("el-form-item",{attrs:{prop:"age"}},[e("el-input",{attrs:{clearable:"",placeholder:"value"},model:{value:s.v,callback:function(e){t.$set(s,"v",e)},expression:"item.v"}})],1)],1),e("el-col",{attrs:{span:4}},[e("el-button",{attrs:{circle:"",icon:"el-icon-plus"},on:{click:t.addFlinkProps}}),l>0?e("el-button",{attrs:{circle:"",icon:"el-icon-minus"},on:{click:t.subFlinkProps}}):t._e()],1)],1)],1)}))],2),e("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[e("el-button",{on:{click:function(e){t.pushTaskVisible=!1}}},[t._v("取 消")]),e("el-button",{attrs:{type:"primary"},on:{click:t.pushTask}},[t._v("推 送")])],1)],1)],1)},a=[],o=(s("14d9"),{name:"FlinkTask",components:{},watch:{},data(){return{queryInfo:{pageNo:1,pageSize:100},flinkConfList:[],flinkModel:[],pushModel:[],flinkProps:{},pushTaskForm:{clusterId:"",parallelism:1,jobIds:[],props:{}},pushTaskVisible:!1,multipleSelection:[],flinkInfos:[]}},created(){this.listFlinkModel(),this.getLocalFlinkInfo(),this.pageFlinkConf()},methods:{async pageFlinkConf(){const{data:t}=await this.$http.get("flinkconf/pageFlinkConf",{params:this.queryInfo});if(200!==t.code)return this.$message.error("获取数据源列表失败！");this.flinkConfList=t.data.records},async listFlinkModel(){const{data:t}=await this.$http.get("flink-model/listFlinkModel");if(200!==t.code)return this.$message.error("获取 flink model 失败！");this.$message.success("获取 flink model 成功！"),this.flinkModel=t.data,this.flinkModel.map(t=>{this.pushModel.push(t.flinkModel)})},async pushTask(){if(this.multipleSelection.map(t=>{this.pushTaskForm.jobIds.push(t.jobId)}),0===this.multipleSelection.length)return this.$message.error("请勾选任务！");if(""===this.pushTaskForm.clusterId)return this.$message.error("请选择推送集群！");this.pushTaskForm.props=this.flinkProps;const{data:t}=await this.$http.post("cdc/pushTask",this.pushTaskForm);this.pushTaskForm.jobIds=[],this.pushTaskVisible=!1},pushTaskClosed(){},selectBtn(t){this.pushModel.forEach(e=>{e===t&&(this.pushTaskForm.model=e)})},handleSelectionChange(t){this.multipleSelection=t},async stopFlinkTask(){if(0===this.multipleSelection.length)return this.$message.error("请勾选任务！");const{data:t}=await this.$http.post("cdc/stopFlinkTask",this.multipleSelection);if(200!==t.code)return this.$message.error("停止任务失败！");this.$message.success("停止任务成功！"),await this.getLocalFlinkInfo()},async getLocalFlinkInfo(){const{data:t}=await this.$http.get("cdc/getLocalFlinkInfo");if(200!==t.code)return this.$message.error("获取 flink info 失败！");this.$message.success("获取 flink info 成功！"),this.flinkInfos=t.data},addFlinkProps(){this.flinkProps.push({k:"",v:""})},subFlinkProps(t){this.flinkProps.splice(t,1)}}}),i=o,n=(s("0c81"),s("2877")),r=Object(n["a"])(i,l,a,!1,null,"59658ccc",null);e["default"]=r.exports}}]);
//# sourceMappingURL=FlinkTask.c0140394.js.map