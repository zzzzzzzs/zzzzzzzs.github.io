(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["Data_Source"],{"30d2":function(a,t,e){},3326:function(a,t,e){"use strict";e("30d2")},d7a7:function(a,t,e){"use strict";e.r(t);var r=function(){var a=this,t=a._self._c;return t("div",[t("el-breadcrumb",{attrs:{"separator-class":"el-icon-arrow-right"}},[t("el-breadcrumb-item",{attrs:{to:{path:"/home"}}},[a._v("首页")]),t("el-breadcrumb-item",[a._v("配置中心")]),t("el-breadcrumb-item",[a._v("数据源中心")])],1),t("el-card",[t("div",{staticClass:"datasource-title"},[a._v(" 数据源 "),t("el-button",{staticClass:"add-btn",attrs:{type:"primary"},on:{click:function(t){a.addDataSourceDialogVisible=!0,a.dataSourceFormTil="创建数据源"}}},[a._v(" 创建数据源 ")])],1),t("el-table",{attrs:{data:a.dataSourceList,border:"",stripe:""}},[t("el-table-column",{attrs:{label:"编号",type:"index"}}),t("el-table-column",{attrs:{label:"数据源类型",prop:"databaseType"}}),t("el-table-column",{attrs:{label:"数据源名称",prop:"databaseName"}}),t("el-table-column",{attrs:{label:"用户名",prop:"userName"}}),t("el-table-column",{attrs:{label:"jdbc 地址",prop:"jdbcUrl"}}),t("el-table-column",{attrs:{label:"是否内网"},scopedSlots:a._u([{key:"default",fn:function(a){return[!0===a.row.isInner?t("i",{staticClass:"el-icon-success",staticStyle:{color:"lightgreen"}}):t("i",{staticClass:"el-icon-message-solid",staticStyle:{color:"orange"}})]}}])}),t("el-table-column",{attrs:{label:"操作",width:"180px"},scopedSlots:a._u([{key:"default",fn:function(e){return[t("el-button",{attrs:{type:"primary",icon:"el-icon-edit",size:"mini"},on:{click:function(t){a.getDataSourceById(e.row.id),a.dataSourceFormTil="编辑数据源"}}}),t("el-button",{attrs:{type:"danger",icon:"el-icon-delete",size:"mini"},on:{click:function(t){return a.delDataSource(e.row.id)}}})]}}])})],1)],1),t("el-dialog",{attrs:{title:a.dataSourceFormTil,visible:a.addDataSourceDialogVisible,width:"50%"},on:{"update:visible":function(t){a.addDataSourceDialogVisible=t},close:a.addDataSourceDialogClosed}},[t("el-form",{ref:"addDataSourceFormRef",attrs:{model:a.addDataSourceForm,"label-width":"140px"}},[t("el-form-item",{attrs:{label:"数据源类型："}},[t("el-select",{attrs:{placeholder:"请选择"},on:{change:a.selectBtn},model:{value:a.addDataSourceForm.databaseType,callback:function(t){a.$set(a.addDataSourceForm,"databaseType",t)},expression:"addDataSourceForm.databaseType"}},a._l(a.dataSourceType,(function(a){return t("el-option",{key:a.databaseType,attrs:{label:a.databaseType,value:a.databaseType}})})),1)],1),t("el-form-item",{attrs:{label:"数据源名称："}},[t("el-input",{model:{value:a.addDataSourceForm.databaseName,callback:function(t){a.$set(a.addDataSourceForm,"databaseName",t)},expression:"addDataSourceForm.databaseName"}})],1),t("el-form-item",{attrs:{label:"用户名："}},[t("el-input",{model:{value:a.addDataSourceForm.userName,callback:function(t){a.$set(a.addDataSourceForm,"userName",t)},expression:"addDataSourceForm.userName"}})],1),t("el-form-item",{attrs:{label:"密码："}},[t("el-input",{model:{value:a.addDataSourceForm.password,callback:function(t){a.$set(a.addDataSourceForm,"password",t)},expression:"addDataSourceForm.password"}})],1),t("el-form-item",{attrs:{label:"jdbc url："}},[t("el-input",{model:{value:a.addDataSourceForm.jdbcUrl,callback:function(t){a.$set(a.addDataSourceForm,"jdbcUrl",t)},expression:"addDataSourceForm.jdbcUrl"}})],1),t("el-form-item",{attrs:{label:"jdbc driver class："}},[t("el-input",{attrs:{disabled:!0},model:{value:a.addDataSourceForm.jdbcDriverClass,callback:function(t){a.$set(a.addDataSourceForm,"jdbcDriverClass",t)},expression:"addDataSourceForm.jdbcDriverClass"}})],1),t("el-form-item",{attrs:{label:"注释："}},[t("el-input",{model:{value:a.addDataSourceForm.comments,callback:function(t){a.$set(a.addDataSourceForm,"comments",t)},expression:"addDataSourceForm.comments"}})],1)],1),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:function(t){a.addDataSourceDialogVisible=!1}}},[a._v("取 消")]),t("el-button",{attrs:{type:"success"},on:{click:a.testJdbc}},[a._v("测试连接")]),t("el-button",{attrs:{type:"primary"},on:{click:a.addDataSource}},[a._v("保 存")])],1)],1)],1)},o=[],s={name:"DataSource",data(){return{queryInfo:{pageNo:1,pageSize:20},dataSourceList:[],total:0,addDataSourceDialogVisible:!1,addDataSourceForm:{databaseType:"",databaseName:"",userName:"",password:"",jdbcUrl:"",jdbcDriverClass:"",comments:""},dataSourceType:[],dataSourceFormTil:"创建数据源"}},created(){this.getDataSourceType(),this.getDataSourceList()},methods:{selectBtn(a){this.dataSourceType.forEach(t=>{t.databaseType===a&&(this.addDataSourceForm.jdbcDriverClass=t.jdbcDriverClass)})},async getDataSourceList(){const{data:a}=await this.$http.get("datasource/listDataSource",{params:this.queryInfo});if(200!==a.code)return this.$message.error("获取数据源列表失败！");this.dataSourceList=a.data.records,this.total=a.data.total},async getDataSourceById(a){const{data:t}=await this.$http.get("datasource/listDataSource",{params:{id:a}});if(200!==t.code)return this.$message.error("获取数据失败!");t.data.records.length>0&&(this.addDataSourceForm=t.data.records[0],this.addDataSourceDialogVisible=!0)},async getDataSourceType(){const{data:a}=await this.$http.get("datasource/dataSourceType");if(200!==a.code)return this.$message.error("获取数据源类型失败！");this.dataSourceType=a.data},handleSizeChange(a){this.queryInfo.pageSize=a,this.getDataSourceList()},handleCurrentChange(a){this.queryInfo.pageNo=a,this.getDataSourceList()},async addDataSource(){const{data:a}=await this.$http.post("datasource/addDataSource",this.addDataSourceForm);this.testJdbc().then(a=>{!0===a&&(this.addDataSourceDialogVisible=!1)}),await this.getDataSourceList()},async delDataSource(a){const{data:t}=await this.$http.post("datasource/delDataSource",{id:a});if(!0!==t.data)return this.$message.error("删除数据源失败！");this.$message.success("删除数据源成功！"),await this.getDataSourceList()},addDataSourceDialogClosed(){this.$refs.addDataSourceFormRef.resetFields(),Object.keys(this.addDataSourceForm).forEach(a=>{this.addDataSourceForm[a]=""})},async testJdbc(){const{data:a}=await this.$http.post("datasource/testJdbc",this.addDataSourceForm);return"1"!==a.data?(this.$message.error("数据源测试连接失败！"),!1):(this.$message.success("数据源测试连接成功！"),!0)}}},d=s,c=(e("3326"),e("2877")),l=Object(c["a"])(d,r,o,!1,null,"30207d86",null);t["default"]=l.exports}}]);
//# sourceMappingURL=Data_Source.7dc6bda0.js.map