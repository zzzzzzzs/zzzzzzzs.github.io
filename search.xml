<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>netty-串口接收</title>
      <link href="2021/02/13/netty/netty-%E4%B8%B2%E5%8F%A3%E6%8E%A5%E6%94%B6/"/>
      <url>2021/02/13/netty/netty-%E4%B8%B2%E5%8F%A3%E6%8E%A5%E6%94%B6/</url>
      
        <content type="html"><![CDATA[<h1 id="netty串口接收"><a href="#netty串口接收" class="headerlink" title="netty串口接收"></a>netty串口接收</h1><p>netty串口，在Windows上使用。 目前只有接收数据。</p><a id="more"></a><p>RxtxClient.java</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.me.netty.rxtx;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> io.netty.bootstrap.Bootstrap;</span><br><span class="line"><span class="keyword">import</span> io.netty.channel.ChannelFuture;</span><br><span class="line"><span class="keyword">import</span> io.netty.channel.ChannelInitializer;</span><br><span class="line"><span class="keyword">import</span> io.netty.channel.oio.OioEventLoopGroup;</span><br><span class="line"><span class="keyword">import</span> io.netty.channel.rxtx.RxtxChannel;</span><br><span class="line"><span class="keyword">import</span> io.netty.channel.rxtx.RxtxChannelConfig;</span><br><span class="line"><span class="keyword">import</span> io.netty.channel.rxtx.RxtxDeviceAddress;</span><br><span class="line"><span class="keyword">import</span> io.netty.channel.*;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">RxtxClient</span> </span>&#123;</span><br><span class="line">    <span class="keyword">static</span> OioEventLoopGroup group = <span class="keyword">new</span> OioEventLoopGroup();</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> RxtxChannel channel;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">buildRxtxClient</span><span class="params">()</span> <span class="keyword">throws</span> InterruptedException </span>&#123;</span><br><span class="line"></span><br><span class="line">        Bootstrap bootstrap = <span class="keyword">new</span> Bootstrap();</span><br><span class="line">        bootstrap.group(group).channelFactory(<span class="keyword">new</span> ChannelFactory&lt;RxtxChannel&gt;() &#123;</span><br><span class="line">            <span class="function"><span class="keyword">public</span> RxtxChannel <span class="title">newChannel</span><span class="params">()</span> </span>&#123;</span><br><span class="line">                <span class="keyword">return</span> channel;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;)</span><br><span class="line">                .handler(<span class="keyword">new</span> ChannelInitializer&lt;RxtxChannel&gt;() &#123;</span><br><span class="line">                    <span class="meta">@Override</span></span><br><span class="line">                    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">initChannel</span><span class="params">(RxtxChannel ch)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">                        ch.pipeline().addLast(</span><br><span class="line"><span class="comment">//                                new LineBasedFrameDecoder(32768),</span></span><br><span class="line"><span class="comment">//                                new StringEncoder(),</span></span><br><span class="line"><span class="comment">//                                new StringDecoder(),</span></span><br><span class="line">                                <span class="comment">// 处理事件</span></span><br><span class="line">                                <span class="keyword">new</span> RxtxClientHandler()</span><br><span class="line">                        );</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;);</span><br><span class="line">        channel = <span class="keyword">new</span> RxtxChannel();</span><br><span class="line">        channel.config().setBaudrate(<span class="number">9600</span>)</span><br><span class="line">                .setDatabits(RxtxChannelConfig.Databits.DATABITS_8)</span><br><span class="line">                .setParitybit(RxtxChannelConfig.Paritybit.NONE)</span><br><span class="line">                .setStopbits(RxtxChannelConfig.Stopbits.STOPBITS_1);</span><br><span class="line">        ChannelFuture  future = bootstrap.connect(<span class="keyword">new</span> RxtxDeviceAddress(<span class="string">&quot;COM3&quot;</span>)).sync();</span><br><span class="line">        future.channel().closeFuture().sync();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            buildRxtxClient();</span><br><span class="line">        &#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;<span class="keyword">finally</span> &#123;</span><br><span class="line">            group.shutdownGracefully();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>RxtxClientHandler.java</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.me.netty.rxtx;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> io.netty.buffer.ByteBuf;</span><br><span class="line"><span class="keyword">import</span> io.netty.channel.ChannelHandlerContext;</span><br><span class="line"><span class="keyword">import</span> io.netty.channel.SimpleChannelInboundHandler;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">RxtxClientHandler</span> <span class="keyword">extends</span> <span class="title">SimpleChannelInboundHandler</span>&lt;<span class="title">ByteBuf</span>&gt; </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">channelRead0</span><span class="params">(ChannelHandlerContext ctx, ByteBuf o)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">byte</span>[] req = <span class="keyword">new</span> <span class="keyword">byte</span>[o.readableBytes()];</span><br><span class="line">        <span class="comment">// 从里面读取数据，这里面的数据是16进制的，0x..</span></span><br><span class="line">        o.readBytes(req);</span><br><span class="line"><span class="comment">//         将hex解码成String</span></span><br><span class="line"><span class="comment">//        System.out.println(new String(req));</span></span><br><span class="line"><span class="comment">//        // 十六进制转换字符串，没有解码</span></span><br><span class="line"><span class="comment">//        String str = HexUtil.encodeHexStr(req);</span></span><br><span class="line"><span class="comment">//        System.out.println(str);</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>GitHub: <a href="https://github.com/zzzzzzzs/netty-rxtx">https://github.com/zzzzzzzs/netty-rxtx</a></p>]]></content>
      
      
      <categories>
          
          <category> netty </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 串口 </tag>
            
            <tag> netty </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Search is art</title>
      <link href="2021/02/11/about/"/>
      <url>2021/02/11/about/</url>
      
        <content type="html"><![CDATA[<p>学会使用搜索将会为您减少时间。</p>]]></content>
      
      
      <categories>
          
          <category> search </category>
          
      </categories>
      
      
        <tags>
            
            <tag> search </tag>
            
        </tags>
      
    </entry>
    
    
  
  
</search>
